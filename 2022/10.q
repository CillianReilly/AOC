r:1+sums raze distinct each 0N,/:first(" J";" ")0:read0`10.txt
{sum y*x -2+y}[r;20 60 100 140 180 220]
{40 cut(".#")1b,(mod[;40]1+til count x)within'-1 1+/:x} -1_r
